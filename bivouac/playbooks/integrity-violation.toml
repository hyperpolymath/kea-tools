# SPDX-License-Identifier: PMPL-1.0-or-later
# Playbook: Handle integrity violations
#
# This playbook is triggered when the system detects an integrity violation,
# such as unauthorized file modifications or configuration drift.

name = "integrity-violation"
description = "Handle integrity violations in the Kea ecosystem"
version = "1.0"
continue_on_error = false
timeout_secs = 300

[trigger]
type = "integrity-violation"
severity = "critical"

[[actions]]
type = "log"
level = "error"
message = "Integrity violation detected! Initiating response procedure."

[[actions]]
type = "command"
cmd = "echo 'Capturing system state for forensics'"
timeout_secs = 30

[[actions]]
type = "notify"
channel = "webhook"
message = "ALERT: Integrity violation detected. Automated response initiated."

[actions.metadata]
priority = "critical"
team = "security"

[[actions]]
type = "log"
level = "info"
message = "Integrity violation response procedure completed."
